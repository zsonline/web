{% extends '_layouts/default.twig' %}

{% from '_macros/feed.twig' import feed %}
{% from '_macros/hero.twig' import hero %}
{% from "_macros/issue.twig" import preview %}

{% set headerSize = 'small' %}
{% set layoutSize = 'medium' %}

{% do craft.app.elements.eagerLoadElements(className(entry), [entry], [
    'issueArticles.group:articles.articleFormat',
    ['issueArticles.group:articles.contentImage', {
        withTransforms: [
            { width: 250, height: 150 }
        ]
    }],
    'issueArticles.group:articles.contributors.other',
    'issueArticles.group:articles.contributors.user:user',
    'issueFile',
    'issueImage'
]) %}

{% set entry = collect([entry]).first() %}

{% set data = [] %}
{% for group in entry.issueArticles %}
    {% set data = data|merge([{
        entries: group.articles,
        title: group.label
    }]) %}
{% endfor %}

{% block main %}
    {{ hero({
        fileName: 'ZS-' ~ entry.issueYear ~ '-' ~ entry.issueNumber ~ '.pdf',
        filePreview: preview({
            issue: entry,
            link: false
        }),
        fileUrl: entry.issueFile.first().url,
        taxonomy: 'Print-Ausgabe',
        taxonomyUrl: url('print'),
        title: entry.title
    }) }}

    {{ feed({
        data: data,
        type: 'article'
    }) }}
{% endblock %}

{% set meta = {
    title: entry.title,
    url: entry.url
} %}
